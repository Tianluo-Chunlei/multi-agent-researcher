# Deep Research 智能体提示词模板分析

## 一、提示词设计原则

基于 Anthropic 的最佳实践，Deep Research 系统的智能体提示词设计遵循以下核心原则：

### 1.1 角色明确性
- 每个智能体都有清晰的角色定位和职责边界
- 避免角色重叠和职责模糊
- 明确智能体在系统中的位置和作用

### 1.2 任务导向性
- 提示词围绕具体任务设计，而非通用对话
- 提供明确的任务执行步骤和预期输出
- 包含任务完成的标准和评估方法

### 1.3 工具集成性
- 明确指定可用的工具和其使用场景
- 提供工具使用的优先级和策略
- 包含工具调用预算和限制

### 1.4 质量控制性
- 内置质量检查和验证机制
- 提供信息源评估标准
- 包含错误处理和恢复策略

## 二、Lead Research Agent 提示词分析

### 2.1 核心结构

```markdown
角色定义 + 当前日期 + 研究流程 + 子智能体数量指导 + 委派指令 + 答案格式 + 内部工具使用 + 并行工具调用 + 重要指导原则
```

### 2.2 关键设计特点

#### 研究流程设计
- **四阶段流程**：评估分解 → 查询类型确定 → 详细计划制定 → 方法执行
- **查询分类系统**：Depth-first、Breadth-first、Straightforward
- **动态调整机制**：根据中间结果调整研究策略

#### 子智能体管理
- **数量指导原则**：
  - 简单查询：1个子智能体
  - 标准查询：2-3个子智能体
  - 中等复杂度：3-5个子智能体
  - 高复杂度：5-20个子智能体（最大限制）
- **任务分配策略**：避免重叠，确保全面覆盖
- **指令清晰性**：提供详细、具体的任务描述

#### 质量控制机制
- **信息验证**：对关键事实进行交叉验证
- **来源评估**：优先使用原始来源
- **冲突处理**：记录并处理信息冲突
- **早停机制**：当收益递减时及时停止

### 2.3 提示词优化点

```markdown
# 优化前的问题
- 缺乏明确的查询分类标准
- 子智能体数量决策不够精确
- 质量检查机制不够完善

# 优化后的改进
- 详细的查询类型定义和示例
- 基于复杂度的精确数量指导
- 多层次质量保证机制
```

## 三、Research Subagent 提示词分析

### 3.1 核心结构

```markdown
角色定义 + 当前日期 + 研究流程 + 研究指导原则 + 来源质量思考 + 并行工具调用 + 最大工具调用限制
```

### 3.2 关键设计特点

#### 研究流程设计
- **三阶段流程**：规划 → 工具选择 → 研究循环
- **OODA循环**：观察-定位-决策-行动
- **预算控制**：根据任务复杂度设定工具调用预算

#### 工具使用策略
- **优先级原则**：内部工具 > 网络工具
- **并行优化**：同时执行多个工具调用
- **效率控制**：最小5次，最大20次工具调用

#### 质量保证机制
- **来源评估**：识别高质量和低质量信息源
- **信息筛选**：避免推测性内容和营销语言
- **冲突标记**：明确标记不确定信息

### 3.3 提示词优化点

```markdown
# 优化前的问题
- 缺乏明确的工具使用优先级
- 质量评估标准不够具体
- 效率控制机制不完善

# 优化后的改进
- 明确的工具优先级和使用策略
- 详细的来源质量评估标准
- 精确的工具调用预算控制
```

## 四、Citation Agent 提示词分析

### 4.1 核心结构

```markdown
角色定义 + 任务描述 + 规则说明 + 引用指导原则 + 技术要求
```

### 4.2 关键设计特点

#### 引用策略
- **选择性引用**：仅对关键声明添加引用
- **语义单元**：引用完整的语义单元
- **最小化碎片**：避免句子过度分割

#### 格式控制
- **内容保护**：保持原始文本100%不变
- **格式一致性**：统一的引用格式
- **技术实现**：使用XML标签进行引用标记

### 4.3 提示词优化点

```markdown
# 优化前的问题
- 引用策略不够明确
- 格式控制要求不够具体
- 技术实现细节不清晰

# 优化后的改进
- 详细的引用策略和原则
- 明确的格式控制要求
- 具体的技术实现指导
```

## 五、提示词模板最佳实践

### 5.1 结构设计原则

#### 层次化组织
```markdown
1. 角色定义（明确身份和职责）
2. 核心流程（详细执行步骤）
3. 指导原则（行为准则和限制）
4. 工具使用（可用工具和使用策略）
5. 质量控制（验证和检查机制）
6. 输出格式（预期输出格式）
```

#### 模块化设计
- 每个模块职责单一，便于维护
- 模块间逻辑清晰，避免冲突
- 支持独立更新和优化

### 5.2 内容设计原则

#### 具体性
- 提供具体的示例和场景
- 明确的操作步骤和判断标准
- 详细的工具使用指导

#### 完整性
- 覆盖所有可能的执行路径
- 包含错误处理和恢复机制
- 提供完整的质量保证流程

#### 一致性
- 术语使用统一
- 格式风格一致
- 逻辑结构清晰

### 5.3 优化策略

#### 迭代优化
- 基于实际使用效果持续改进
- 收集反馈并调整提示词
- 定期评估和更新

#### 版本控制
- 维护提示词版本历史
- 记录修改原因和效果
- 支持回滚和对比

## 六、提示词模板库

### 6.1 Lead Research Agent 模板

```markdown
# 基础模板结构
You are an expert research lead, focused on high-level research strategy, planning, efficient delegation to subagents, and final report writing.

## 核心流程
<research_process>
1. Assessment and breakdown
2. Query type determination  
3. Detailed research plan development
4. Methodical plan execution
</research_process>

## 子智能体管理
<subagent_count_guidelines>
- 简单查询：1个子智能体
- 标准查询：2-3个子智能体
- 中等复杂度：3-5个子智能体
- 高复杂度：5-20个子智能体
</subagent_count_guidelines>

## 委派指令
<delegation_instructions>
- 提供详细任务描述
- 避免任务重叠
- 确保全面覆盖
</delegation_instructions>
```

### 6.2 Research Subagent 模板

```markdown
# 基础模板结构
You are a research subagent working as part of a team.

## 研究流程
<research_process>
1. Planning
2. Tool selection
3. Research loop (OODA)
</research_process>

## 工具使用
- 内部工具优先
- 并行工具调用
- 预算控制（5-20次调用）

## 质量控制
- 来源评估
- 信息筛选
- 冲突标记
```

### 6.3 Citation Agent 模板

```markdown
# 基础模板结构
You are an agent for adding correct citations to a research report.

## 引用策略
- 选择性引用关键声明
- 完整语义单元
- 最小化句子碎片

## 格式控制
- 保持原始内容不变
- 统一引用格式
- XML标签实现
```

## 七、实施建议

### 7.1 开发阶段
1. **原型验证**：使用基础模板进行功能验证
2. **迭代优化**：基于测试结果持续改进
3. **性能调优**：优化提示词长度和复杂度

### 7.2 部署阶段
1. **版本管理**：建立提示词版本控制系统
2. **监控机制**：监控智能体执行效果
3. **反馈收集**：收集用户反馈并持续改进

### 7.3 维护阶段
1. **定期评估**：定期评估提示词效果
2. **更新机制**：建立提示词更新流程
3. **文档维护**：保持文档与代码同步

## 八、总结

Deep Research 系统的智能体提示词设计体现了以下核心价值：

- **专业性**：每个智能体都有明确的专业角色和职责
- **效率性**：通过并行执行和智能分配最大化效率
- **质量性**：多层次质量保证机制确保结果可靠性
- **可维护性**：模块化设计便于维护和扩展

这些提示词模板为构建高效、可靠的多智能体研究系统提供了坚实的基础。
